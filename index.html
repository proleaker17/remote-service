<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- This viewport tag is crucial for responsive design on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Chat Simulator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for the app */
        body {
            font-family: 'Inter', sans-serif;
            /* Prevent body scroll when chat is active, important for the fullscreen mobile experience */
            overflow: hidden; 
        }

        /* Custom scrollbar for chat window */
        #chat-window::-webkit-scrollbar {
            width: 6px;
        }
        #chat-window::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 10px;
        }
        #chat-window::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 10px;
        }
        #chat-window::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }
        
        /* Transition for fullscreen effect */
        #chat-container {
            transition: all 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-slate-100 flex items-center justify-center h-screen">

    <!-- Push Notification Area -->
    <!-- Using max-w-sm ensures the notification looks good on phones (taking most of the width) and doesn't stretch too wide on desktops -->
    <div id="push-notification" class="fixed top-0 left-1/2 -translate-x-1/2 w-full max-w-sm p-4 transition-transform duration-500 ease-in-out -translate-y-full z-50">
        <div class="bg-white rounded-2xl shadow-2xl p-4 flex items-center ring-1 ring-black ring-opacity-5">
            <div class="flex-shrink-0">
                <!-- Star Icon for the reward -->
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                </svg>
            </div>
            <div class="ml-3 w-0 flex-1">
                <p id="notification-text" class="text-sm font-medium text-slate-700">You earned a reward for helping customers!</p>
            </div>
        </div>
    </div>


    <div id="chat-container" class="w-full max-w-md mx-4">
        <div class="bg-white rounded-2xl shadow-2xl flex flex-col h-[70vh] transition-all duration-300">
            <!-- Header -->
            <div class="bg-slate-800 text-white p-4 rounded-t-2xl flex items-center shadow-md flex-shrink-0">
                <div class="relative">
                    <img class="w-10 h-10 rounded-full" src="https://placehold.co/100x100/7e22ce/white?text=C" alt="Customer Avatar">
                    <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-slate-800 rounded-full"></span>
                </div>
                <div class="ml-3">
                    <p class="font-semibold">Customer Support</p>
                    <p class="text-xs text-slate-300">Online</p>
                </div>
            </div>

            <!-- Chat Window -->
            <div id="chat-window" class="flex-1 p-6 overflow-y-auto space-y-4">
                <!-- Messages will be appended here -->
            </div>

            <!-- Input Area -->
            <div id="input-area" class="p-4 bg-slate-50 border-t border-slate-200 rounded-b-2xl flex-shrink-0">
                <!-- Start Button Container -->
                <div id="start-chat-container" class="text-center">
                    <button id="start-chat-btn" class="bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition-all duration-300 shadow-lg focus:outline-none focus:ring-4 focus:ring-indigo-300">
                        Start Chat
                    </button>
                </div>

                <!-- Message Form (initially hidden) -->
                <form id="message-form" class="hidden">
                    <div class="flex items-center space-x-3">
                        <input type="text" id="message-input" placeholder="Type your message..." autocomplete="off" class="w-full bg-slate-200 border-transparent rounded-lg py-3 px-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition">
                        <button type="submit" class="bg-indigo-600 text-white p-3 rounded-full hover:bg-indigo-700 transition-all duration-300 shadow-md focus:outline-none focus:ring-4 focus:ring-indigo-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" /></svg>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // DOM Elements
            const chatContainer = document.getElementById('chat-container');
            const startChatBtn = document.getElementById('start-chat-btn');
            const startChatContainer = document.getElementById('start-chat-container');
            const messageForm = document.getElementById('message-form');
            const messageInput = document.getElementById('message-input');
            const chatWindow = document.getElementById('chat-window');
            const pushNotification = document.getElementById('push-notification');
            const notificationText = document.getElementById('notification-text');

            // State
            let hasUserReplied = false;

            // Pre-defined customer questions
            const customerQuestions = [
                "Hi, can you tell me more about your return policy?",
                "What are your business hours during the holidays?",
                "I'm having trouble with my order, can you help?",
                "Do you offer any discounts for new customers?",
                "What's the estimated shipping time for an order to California?"
            ];

            // --- Event Listeners ---

            // 1. Start the chat and go fullscreen
            startChatBtn.addEventListener('click', () => {
                // Expand to fullscreen, which works well on all devices including phones
                const chatBox = chatContainer.querySelector('.flex-col');
                chatContainer.classList.remove('max-w-md', 'mx-4');
                chatContainer.classList.add('w-screen', 'h-screen');
                chatBox.classList.remove('h-[70vh]', 'rounded-2xl');
                chatBox.classList.add('h-full', 'rounded-none');
                
                // Hide start button and show form
                startChatContainer.classList.add('hidden');
                messageForm.classList.remove('hidden');
                messageInput.focus();

                // Simulate customer writing a message after a delay
                const randomDelay = Math.random() * (6000 - 3000) + 3000; // 3-6 seconds
                setTimeout(() => {
                    const randomQuestion = customerQuestions[Math.floor(Math.random() * customerQuestions.length)];
                    addMessage('customer', randomQuestion);
                }, randomDelay);
            });

            // 2. Send a message
            messageForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const messageText = messageInput.value.trim();

                if (messageText) {
                    addMessage('user', messageText);
                    messageInput.value = '';

                    // If this is the first reply, trigger the customer thank you and reward notification
                    if (!hasUserReplied) {
                        hasUserReplied = true;
                        
                        // Simulate customer replying with thanks after a short delay
                        setTimeout(() => {
                            addMessage('customer', "Great, thank you so much for your help!");
                        }, 1200);

                        // Show the push notification after the customer's reply
                        setTimeout(() => {
                           showPushNotification("You earned a reward for helping customers!");
                        }, 2500);
                    }
                }
            });


            // --- Helper Functions ---

            /**
             * Adds a user or customer message to the chat window.
             * @param {string} sender - 'user' or 'customer'
             * @param {string} text - The message content
             */
            function addMessage(sender, text) {
                const messageElement = document.createElement('div');
                // MOBILE ENHANCEMENT: Using a percentage-based max-width makes bubbles more fluid on different screen sizes.
                messageElement.classList.add('flex', 'items-end', 'max-w-[80%]');
                
                // Add a simple fade-in animation
                messageElement.style.opacity = '0';
                messageElement.style.transition = 'opacity 0.5s';

                if (sender === 'user') {
                    messageElement.classList.add('ml-auto', 'justify-end');
                    messageElement.innerHTML = `
                        <div class="bg-indigo-600 text-white p-3 rounded-l-lg rounded-br-lg shadow">
                            <p class="text-sm break-words">${text}</p>
                        </div>
                    `;
                } else {
                    messageElement.classList.add('mr-auto');
                    messageElement.innerHTML = `
                        <img class="w-8 h-8 rounded-full mr-3 mb-1" src="https://placehold.co/100x100/7e22ce/white?text=C" alt="Customer Avatar">
                        <div class="bg-slate-200 text-slate-800 p-3 rounded-r-lg rounded-bl-lg shadow">
                            <p class="text-sm break-words">${text}</p>
                        </div>
                    `;
                }

                chatWindow.appendChild(messageElement);
                // Trigger the fade-in
                setTimeout(() => messageElement.style.opacity = '1', 10);
                
                // Scroll to the bottom
                chatWindow.scrollTop = chatWindow.scrollHeight;
            }

            /**
             * Shows a push notification from the top of the screen.
             * @param {string} text - The notification content.
             */
            function showPushNotification(text) {
                if (pushNotification && notificationText) {
                    notificationText.textContent = text;
                    
                    // Slide down into view
                    pushNotification.classList.remove('-translate-y-full');
                    pushNotification.classList.add('translate-y-4'); // Add some top margin

                    // Slide back up after a few seconds
                    setTimeout(() => {
                        pushNotification.classList.remove('translate-y-4');
                        pushNotification.classList.add('-translate-y-full');
                    }, 4000); // Keep it on screen for 4 seconds
                }
            }
        });
    </script>

</body>
</html>
